<style>
    /* Ultra-aggressive title styling override */
    #title, h1#title, .post-header h1, h1.gradient-text {
        font-size: 3.75rem !important; /* ~text-7xl */
        font-weight: 800 !important;
        line-height: 1.1 !important;
        letter-spacing: -0.025em !important;
    }
    
    @media (min-width: 768px) {
        #title, h1#title, .post-header h1, h1.gradient-text {
            font-size: 4.5rem !important; /* Even larger than text-7xl */
        }
    }
    
    /* Mobile-first responsive typography for article content */
    .article-content.prose {
        font-size: 1.125rem !important; /* 18px - larger than default 16px */
        line-height: 1.7 !important;
    }
    
    .article-content.prose p {
        font-size: 1.125rem !important; /* 18px */
        line-height: 1.7 !important;
    }
    
    /* Tablet and up */
    @media (min-width: 768px) {
        .article-content.prose {
            font-size: 1.25rem !important; /* 20px */
            line-height: 1.8 !important;
        }
        
        .article-content.prose p {
            font-size: 1.25rem !important; /* 20px */
            line-height: 1.8 !important;
        }
    }
    
    /* Desktop */
    @media (min-width: 1024px) {
        .article-content.prose {
            font-size: 1.375rem !important; /* 22px */
            line-height: 1.8 !important;
        }
        
        .article-content.prose p {
            font-size: 1.375rem !important; /* 22px */
            line-height: 1.8 !important;
        }
    }
    
    /* Floating cover image above article */
    .cover-floating-container {
        position: relative;
        width: 100%;
        margin: 2.5rem auto 0; /* Space from search bar */
        z-index: 20;
    }
    
    /* True boundary-breaking cover image */
    .boundary-break-container {
        position: relative;
        width: calc(100% + 3rem); /* Extend 1.5rem on each side beyond article */
        left: -1.5rem; /* Pull left edge 1.5rem beyond container */
        height: 380px; /* Reduced from 450px for smaller image */
        overflow: visible;
        z-index: 20;
    }
    
    /* Glow effect that extends beyond image */
    .boundary-break-glow {
        position: absolute;
        top: -2rem;
        left: -2rem;
        right: -2rem;
        bottom: -1rem;
        background: linear-gradient(45deg, 
            rgba(211, 124, 95, 0.7),  /* accent-warm */
            rgba(96, 138, 159, 0.7),  /* accent-cool */
            rgba(106, 138, 130, 0.7)  /* accent-green */
        );
        filter: blur(2.5rem);
        border-radius: 1rem;
        opacity: 0.8;
        z-index: 10;
        animation: boundary-break-pulse 4s infinite alternate;
    }
    
    @keyframes boundary-break-pulse {
        0% { opacity: 0.7; filter: blur(2rem); }
        100% { opacity: 0.9; filter: blur(3rem); }
    }
    
    /* Image styling */
    .boundary-break-image {
        position: relative;
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 0.75rem;
        border: 0.5rem solid white;
        box-shadow: 0 2rem 4rem -1rem rgba(0,0,0,0.8), 0 0 2.5rem 0.25rem rgba(0,0,0,0.5);
        transform: scale(1.05);
        transition: transform 0.4s cubic-bezier(0.165, 0.84, 0.44, 1),
                    box-shadow 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
        z-index: 20;
    }
    
    /* Hover effect */
    .boundary-break-image:hover {
        transform: scale(1.08) translateY(-0.5rem);
        box-shadow: 0 2.5rem 4.5rem -1rem rgba(0,0,0,0.85), 0 0 3rem 0.25rem rgba(0,0,0,0.6);
    }
    
    /* Article container styling */
    .post-container {
        margin-top: -3.5rem; /* Reduced overlap for breathing room */
        padding-top: 5rem; /* Adjusted padding to maintain proper spacing */
        position: relative;
        z-index: 10;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
        .boundary-break-container {
            width: calc(100% + 2rem);
            left: -1rem;
            height: auto; /* Auto height to prevent cropping */
            max-height: 350px; /* Maximum height constraint */
        }
        
        .boundary-break-glow {
            top: -1.5rem;
            left: -1.5rem;
            right: -1.5rem;
            bottom: -0.75rem;
        }
        
        .boundary-break-image {
            height: auto; /* Let height be determined by aspect ratio */
            max-height: 350px;
            object-fit: contain; /* Show entire image without cropping */
            transform: scale(1.02); /* Slightly reduced scale for mobile */
        }
        
        .post-container {
            margin-top: -5rem;
            padding-top: 6rem;
        }
    }
    
    /* Small mobile devices */
    @media (max-width: 480px) {
        .boundary-break-container {
            height: auto;
            max-height: 280px;
        }
        
        .boundary-break-image {
            max-height: 280px;
            border-width: 0.25rem;
        }
    }
</style>

<div class="cover-floating-container">
    <div class="boundary-break-container">
        <div class="boundary-break-glow"></div>
        <img 
            src="/media/traefik-01.png" 
            alt="Traefik cover image" 
            class="boundary-break-image"
        >
    </div>
</div>

<article class='w-full pattern-card glow-card p-4 md:p-6 post-container'>
<section class="post-header mb-8">
    <h1 id="title" style="font-size: 4rem; line-height: 1.1; font-weight: 800;" class="text-6xl md:text-7xl font-extrabold gradient-text mb-4 post-title-large">Traefik</h1>
    <div class="flex items-center text-sm text-text-main/80 mb-6">
        <time datetime="2022-03-06">
            March 06, 2022
        </time>
    </div>
    <div class="flex flex-wrap gap-2">
            <a href="https://pype.dev//tags/homelab/" class="inline-block bg-primary-light text-accent-cool text-xs font-medium px-3 py-1 rounded-full hover:bg-primary-light/80 transition-colors border border-accent-cool/20 hover-lift">
                #homelab
            </a>
            <a href="https://pype.dev//tags/tech/" class="inline-block bg-primary-light text-accent-cool text-xs font-medium px-3 py-1 rounded-full hover:bg-primary-light/80 transition-colors border border-accent-cool/20 hover-lift">
                #tech
            </a>
    </div>
</section>    <section class="article-content prose dark:prose-invert mx-auto mt-8">
        <h1 id="traefik">Traefik <a class="header-anchor" href="#traefik"><svg class="heading-permalink" aria-hidden="true" fill="currentColor" focusable="false" height="1em" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M9.199 13.599a5.99 5.99 0 0 0 3.949 2.345 5.987 5.987 0 0 0 5.105-1.702l2.995-2.994a5.992 5.992 0 0 0 1.695-4.285 5.976 5.976 0 0 0-1.831-4.211 5.99 5.99 0 0 0-6.431-1.242 6.003 6.003 0 0 0-1.905 1.24l-1.731 1.721a.999.999 0 1 0 1.41 1.418l1.709-1.699a3.985 3.985 0 0 1 2.761-1.123 3.975 3.975 0 0 1 2.799 1.122 3.997 3.997 0 0 1 .111 5.644l-3.005 3.006a3.982 3.982 0 0 1-3.395 1.126 3.987 3.987 0 0 1-2.632-1.563A1 1 0 0 0 9.201 13.6zm5.602-3.198a5.99 5.99 0 0 0-3.949-2.345 5.987 5.987 0 0 0-5.105 1.702l-2.995 2.994a5.992 5.992 0 0 0-1.695 4.285 5.976 5.976 0 0 0 1.831 4.211 5.99 5.99 0 0 0 6.431 1.242 6.003 6.003 0 0 0 1.905-1.24l1.723-1.723a.999.999 0 1 0-1.414-1.414L9.836 19.81a3.985 3.985 0 0 1-2.761 1.123 3.975 3.975 0 0 1-2.799-1.122 3.997 3.997 0 0 1-.111-5.644l3.005-3.006a3.982 3.982 0 0 1 3.395-1.126 3.987 3.987 0 0 1 2.632 1.563 1 1 0 0 0 1.602-1.198z"></path></svg></a></h1>
<p>If you don't know about <a href="https://doc.traefik.io/traefik/">traefik</a> and you need a reverse-proxy then you might want to check it out.
I used to use nginx for my reverse proxy but the config was over my head, and once it was working I was afraid to touch it.
Traefik brings a lot to the table, my main uses are reverse proxy and ip whitelisting, but it's doing even more under the hood that I don't have a full-grasp of yet.</p>
<p>I like Traefik a lot because once I get some basic config up it's incredibly easy to add services into my homelab whether they run on my primary server or not.
This will not be exhaustive but I'll outline my simple setup process of traefik and how I add services whether they are in docker or not.</p>
<h1 id="docker">Docker <a class="header-anchor" href="#docker"><svg class="heading-permalink" aria-hidden="true" fill="currentColor" focusable="false" height="1em" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M9.199 13.599a5.99 5.99 0 0 0 3.949 2.345 5.987 5.987 0 0 0 5.105-1.702l2.995-2.994a5.992 5.992 0 0 0 1.695-4.285 5.976 5.976 0 0 0-1.831-4.211 5.99 5.99 0 0 0-6.431-1.242 6.003 6.003 0 0 0-1.905 1.24l-1.731 1.721a.999.999 0 1 0 1.41 1.418l1.709-1.699a3.985 3.985 0 0 1 2.761-1.123 3.975 3.975 0 0 1 2.799 1.122 3.997 3.997 0 0 1 .111 5.644l-3.005 3.006a3.982 3.982 0 0 1-3.395 1.126 3.987 3.987 0 0 1-2.632-1.563A1 1 0 0 0 9.201 13.6zm5.602-3.198a5.99 5.99 0 0 0-3.949-2.345 5.987 5.987 0 0 0-5.105 1.702l-2.995 2.994a5.992 5.992 0 0 0-1.695 4.285 5.976 5.976 0 0 0 1.831 4.211 5.99 5.99 0 0 0 6.431 1.242 6.003 6.003 0 0 0 1.905-1.24l1.723-1.723a.999.999 0 1 0-1.414-1.414L9.836 19.81a3.985 3.985 0 0 1-2.761 1.123 3.975 3.975 0 0 1-2.799-1.122 3.997 3.997 0 0 1-.111-5.644l3.005-3.006a3.982 3.982 0 0 1 3.395-1.126 3.987 3.987 0 0 1 2.632 1.563 1 1 0 0 0 1.602-1.198z"></path></svg></a></h1>
<p>In 2022 I'm still a docker fan-boy and I run my traefik instance in a docker container.
This isn't necessary but I love the portability since my homelab is very dynamic at the moment.
And even if it wasn't I'd still want to keep traefik in docker because deployment and updating are just so flipping easy</p>
<p>A simple docker-compose file for traefik might look like this:</p>
<pre class='wrapper'>

<div class='copy-wrapper'>

<button class='copy' title='copy code to clipboard' onclick="navigator.clipboard.writeText(this.parentElement.parentElement.querySelector('pre').textContent)"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 115.77 122.88" style="enable-background:new 0 0 115.77 122.88" xml:space="preserve"><style type="text/css">.st0{fill-rule:evenodd;clip-rule:evenodd;}</style><g><path class="st0" d="M89.62,13.96v7.73h12.19h0.01v0.02c3.85,0.01,7.34,1.57,9.86,4.1c2.5,2.51,4.06,5.98,4.07,9.82h0.02v0.02 v73.27v0.01h-0.02c-0.01,3.84-1.57,7.33-4.1,9.86c-2.51,2.5-5.98,4.06-9.82,4.07v0.02h-0.02h-61.7H40.1v-0.02 c-3.84-0.01-7.34-1.57-9.86-4.1c-2.5-2.51-4.06-5.98-4.07-9.82h-0.02v-0.02V92.51H13.96h-0.01v-0.02c-3.84-0.01-7.34-1.57-9.86-4.1 c-2.5-2.51-4.06-5.98-4.07-9.82H0v-0.02V13.96v-0.01h0.02c0.01-3.85,1.58-7.34,4.1-9.86c2.51-2.5,5.98-4.06,9.82-4.07V0h0.02h61.7 h0.01v0.02c3.85,0.01,7.34,1.57,9.86,4.1c2.5,2.51,4.06,5.98,4.07,9.82h0.02V13.96L89.62,13.96z M79.04,21.69v-7.73v-0.02h0.02 c0-0.91-0.39-1.75-1.01-2.37c-0.61-0.61-1.46-1-2.37-1v0.02h-0.01h-61.7h-0.02v-0.02c-0.91,0-1.75,0.39-2.37,1.01 c-0.61,0.61-1,1.46-1,2.37h0.02v0.01v64.59v0.02h-0.02c0,0.91,0.39,1.75,1.01,2.37c0.61,0.61,1.46,1,2.37,1v-0.02h0.01h12.19V35.65 v-0.01h0.02c0.01-3.85,1.58-7.34,4.1-9.86c2.51-2.5,5.98-4.06,9.82-4.07v-0.02h0.02H79.04L79.04,21.69z M105.18,108.92V35.65v-0.02 h0.02c0-0.91-0.39-1.75-1.01-2.37c-0.61-0.61-1.46-1-2.37-1v0.02h-0.01h-61.7h-0.02v-0.02c-0.91,0-1.75,0.39-2.37,1.01 c-0.61,0.61-1,1.46-1,2.37h0.02v0.01v73.27v0.02h-0.02c0,0.91,0.39,1.75,1.01,2.37c0.61,0.61,1.46,1,2.37,1v-0.02h0.01h61.7h0.02 v0.02c0.91,0,1.75-0.39,2.37-1.01c0.61-0.61,1-1.46,1-2.37h-0.02V108.92L105.18,108.92z"/></g></svg></button>
</div>
        
<div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">traefik</span>
<span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;traefik:v2.4&quot;</span>
<span class="nt">network_mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;docker-data/traefik/traefik.toml:/etc/traefik/traefik.toml:ro&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;docker-data/traefik/config.yml:/etc/traefik/config.yml:ro&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;docker-data/traefik/letsencrypt:/letsencrypt:rw&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;/var/run/docker.sock:/var/run/docker.sock:ro&quot;</span><span class="w">  </span><span class="c1"># for auto-discovery</span>
<span class="nt">env</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">traefik_environment_variables</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="nt">restart_policy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
<span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1g&quot;</span>
</pre></div>

</pre>

<h1 id="ansible-deployment">Ansible deployment <a class="header-anchor" href="#ansible-deployment"><svg class="heading-permalink" aria-hidden="true" fill="currentColor" focusable="false" height="1em" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M9.199 13.599a5.99 5.99 0 0 0 3.949 2.345 5.987 5.987 0 0 0 5.105-1.702l2.995-2.994a5.992 5.992 0 0 0 1.695-4.285 5.976 5.976 0 0 0-1.831-4.211 5.99 5.99 0 0 0-6.431-1.242 6.003 6.003 0 0 0-1.905 1.24l-1.731 1.721a.999.999 0 1 0 1.41 1.418l1.709-1.699a3.985 3.985 0 0 1 2.761-1.123 3.975 3.975 0 0 1 2.799 1.122 3.997 3.997 0 0 1 .111 5.644l-3.005 3.006a3.982 3.982 0 0 1-3.395 1.126 3.987 3.987 0 0 1-2.632-1.563A1 1 0 0 0 9.201 13.6zm5.602-3.198a5.99 5.99 0 0 0-3.949-2.345 5.987 5.987 0 0 0-5.105 1.702l-2.995 2.994a5.992 5.992 0 0 0-1.695 4.285 5.976 5.976 0 0 0 1.831 4.211 5.99 5.99 0 0 0 6.431 1.242 6.003 6.003 0 0 0 1.905-1.24l1.723-1.723a.999.999 0 1 0-1.414-1.414L9.836 19.81a3.985 3.985 0 0 1-2.761 1.123 3.975 3.975 0 0 1-2.799-1.122 3.997 3.997 0 0 1-.111-5.644l3.005-3.006a3.982 3.982 0 0 1 3.395-1.126 3.987 3.987 0 0 1 2.632 1.563 1 1 0 0 0 1.602-1.198z"></path></svg></a></h1>
<p><strong>I plan to have more on my homelab and Ansible on this site eventually...</strong></p>
<p>I use Ansible to deploy most of my services at home, including traefik. My main homelab repo is <a href="https://github.com/nicpayne713/ansible-nas">here</a> which is a fork of <a href="https://github.com/davestephens/ansible-nas">Ansible NAS</a>.</p>
<blockquote>
<p>If you want my stuff then be sure to go to the <code>user/nic</code> branch on my fork</p>
</blockquote>
<p>You can see the ansible stuff for traefik <a href="https://github.com/davestephens/ansible-nas/tree/master/roles/traefik">here</a></p>
<h1 id="config">Config <a class="header-anchor" href="#config"><svg class="heading-permalink" aria-hidden="true" fill="currentColor" focusable="false" height="1em" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M9.199 13.599a5.99 5.99 0 0 0 3.949 2.345 5.987 5.987 0 0 0 5.105-1.702l2.995-2.994a5.992 5.992 0 0 0 1.695-4.285 5.976 5.976 0 0 0-1.831-4.211 5.99 5.99 0 0 0-6.431-1.242 6.003 6.003 0 0 0-1.905 1.24l-1.731 1.721a.999.999 0 1 0 1.41 1.418l1.709-1.699a3.985 3.985 0 0 1 2.761-1.123 3.975 3.975 0 0 1 2.799 1.122 3.997 3.997 0 0 1 .111 5.644l-3.005 3.006a3.982 3.982 0 0 1-3.395 1.126 3.987 3.987 0 0 1-2.632-1.563A1 1 0 0 0 9.201 13.6zm5.602-3.198a5.99 5.99 0 0 0-3.949-2.345 5.987 5.987 0 0 0-5.105 1.702l-2.995 2.994a5.992 5.992 0 0 0-1.695 4.285 5.976 5.976 0 0 0 1.831 4.211 5.99 5.99 0 0 0 6.431 1.242 6.003 6.003 0 0 0 1.905-1.24l1.723-1.723a.999.999 0 1 0-1.414-1.414L9.836 19.81a3.985 3.985 0 0 1-2.761 1.123 3.975 3.975 0 0 1-2.799-1.122 3.997 3.997 0 0 1-.111-5.644l3.005-3.006a3.982 3.982 0 0 1 3.395-1.126 3.987 3.987 0 0 1 2.632 1.563 1 1 0 0 0 1.602-1.198z"></path></svg></a></h1>
<p>I use a <code>traefik.toml</code> as the main config and it looks something like this.
With ansible a lot of this is done through template variables but this is the general idea.
This config tells traefik what ports to listen and forward on, and gives the names to be referenced by docker labels (down below).</p>
<p>Traefik also has a handy web ui that with this config you can find on port <code>8080</code>.
There is a <code>providers</code> section - which is one of the biggest selling points of traefik for me.
I have a docker provider configured  and a static file.</p>
<p>The docker provider lets traefik auto-discover new services that I deploy and automatically handle the routing!
The static file lets me easily add non-dockerized service routing, or routing to dockerized services on another host (I think traefik has an easier way to do this automatically but I don't do it often enough to need that kind of automation).
Then at the bottom is the SSL cert stuff.
Using Let's Encrypt is pretty easy and I use Cloudflare as my DNS provider</p>
<pre class='wrapper'>

<div class='copy-wrapper'>

<button class='copy' title='copy code to clipboard' onclick="navigator.clipboard.writeText(this.parentElement.parentElement.querySelector('pre').textContent)"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 115.77 122.88" style="enable-background:new 0 0 115.77 122.88" xml:space="preserve"><style type="text/css">.st0{fill-rule:evenodd;clip-rule:evenodd;}</style><g><path class="st0" d="M89.62,13.96v7.73h12.19h0.01v0.02c3.85,0.01,7.34,1.57,9.86,4.1c2.5,2.51,4.06,5.98,4.07,9.82h0.02v0.02 v73.27v0.01h-0.02c-0.01,3.84-1.57,7.33-4.1,9.86c-2.51,2.5-5.98,4.06-9.82,4.07v0.02h-0.02h-61.7H40.1v-0.02 c-3.84-0.01-7.34-1.57-9.86-4.1c-2.5-2.51-4.06-5.98-4.07-9.82h-0.02v-0.02V92.51H13.96h-0.01v-0.02c-3.84-0.01-7.34-1.57-9.86-4.1 c-2.5-2.51-4.06-5.98-4.07-9.82H0v-0.02V13.96v-0.01h0.02c0.01-3.85,1.58-7.34,4.1-9.86c2.51-2.5,5.98-4.06,9.82-4.07V0h0.02h61.7 h0.01v0.02c3.85,0.01,7.34,1.57,9.86,4.1c2.5,2.51,4.06,5.98,4.07,9.82h0.02V13.96L89.62,13.96z M79.04,21.69v-7.73v-0.02h0.02 c0-0.91-0.39-1.75-1.01-2.37c-0.61-0.61-1.46-1-2.37-1v0.02h-0.01h-61.7h-0.02v-0.02c-0.91,0-1.75,0.39-2.37,1.01 c-0.61,0.61-1,1.46-1,2.37h0.02v0.01v64.59v0.02h-0.02c0,0.91,0.39,1.75,1.01,2.37c0.61,0.61,1.46,1,2.37,1v-0.02h0.01h12.19V35.65 v-0.01h0.02c0.01-3.85,1.58-7.34,4.1-9.86c2.51-2.5,5.98-4.06,9.82-4.07v-0.02h0.02H79.04L79.04,21.69z M105.18,108.92V35.65v-0.02 h0.02c0-0.91-0.39-1.75-1.01-2.37c-0.61-0.61-1.46-1-2.37-1v0.02h-0.01h-61.7h-0.02v-0.02c-0.91,0-1.75,0.39-2.37,1.01 c-0.61,0.61-1,1.46-1,2.37h0.02v0.01v73.27v0.02h-0.02c0,0.91,0.39,1.75,1.01,2.37c0.61,0.61,1.46,1,2.37,1v-0.02h0.01h61.7h0.02 v0.02c0.91,0,1.75-0.39,2.37-1.01c0.61-0.61,1-1.46,1-2.37h-0.02V108.92L105.18,108.92z"/></g></svg></button>
</div>
        
<div class="highlight"><pre><span></span><span class="k">[entryPoints]</span>
<span class="k">[entryPoints.web]</span>
<span class="n">address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;:80&quot;</span>

<span class="k">[entryPoints.web.http.redirections.entryPoint]</span>
<span class="n">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;websecure&quot;</span>

<span class="k">[entryPoints.websecure]</span>
<span class="n">address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;:443&quot;</span>

<span class="k">[entryPoints.websecure.http.tls]</span>
<span class="n">certResolver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;letsencrypt&quot;</span>

<span class="k">[entryPoints.websecure.http.tls.domains]</span>
<span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;example.com&quot;</span>
<span class="n">sans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="s2">&quot;*.example.com&quot;</span>
<span class="p">]</span>

<span class="k">[entryPoints.traefik]</span>
<span class="n">address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;:8080&quot;</span>

<span class="k">[providers]</span>
<span class="n">providersThrottleDuration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;1s&quot;</span>
<span class="k">[providers.docker]</span>
<span class="n">exposedbydefault</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="k">[providers.file]</span>
<span class="n">filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;/etc/traefik/config.yml&quot;</span>

<span class="k">[api]</span>
<span class="n">insecure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="n">dashboard</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>

<span class="k">[log]</span>
<span class="n">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;INFO&quot;</span>

<span class="k">[ping]</span>
<span class="n">terminatingStatusCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="k">[certificatesResolvers]</span>
<span class="k">[certificatesResolvers.letsencrypt]</span>
<span class="k">[certificatesResolvers.letsencrypt.acme]</span>
<span class="n">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;my_email@example.com&quot;</span>
<span class="n">storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;/letsencrypt/acme.json&quot;</span>
<span class="n">caserver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://acme-staging-v02.api.letsencrypt.org/directory&quot;</span><span class="w">  </span><span class="c1"># le staging, not prod</span>

<span class="k">[certificatesResolvers.letsencrypt.acme.dnsChallenge]</span>
<span class="n">provider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;cloudflare&quot;</span>
</pre></div>

</pre>

<h1 id="providersfile">Providers.file <a class="header-anchor" href="#providersfile"><svg class="heading-permalink" aria-hidden="true" fill="currentColor" focusable="false" height="1em" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M9.199 13.599a5.99 5.99 0 0 0 3.949 2.345 5.987 5.987 0 0 0 5.105-1.702l2.995-2.994a5.992 5.992 0 0 0 1.695-4.285 5.976 5.976 0 0 0-1.831-4.211 5.99 5.99 0 0 0-6.431-1.242 6.003 6.003 0 0 0-1.905 1.24l-1.731 1.721a.999.999 0 1 0 1.41 1.418l1.709-1.699a3.985 3.985 0 0 1 2.761-1.123 3.975 3.975 0 0 1 2.799 1.122 3.997 3.997 0 0 1 .111 5.644l-3.005 3.006a3.982 3.982 0 0 1-3.395 1.126 3.987 3.987 0 0 1-2.632-1.563A1 1 0 0 0 9.201 13.6zm5.602-3.198a5.99 5.99 0 0 0-3.949-2.345 5.987 5.987 0 0 0-5.105 1.702l-2.995 2.994a5.992 5.992 0 0 0-1.695 4.285 5.976 5.976 0 0 0 1.831 4.211 5.99 5.99 0 0 0 6.431 1.242 6.003 6.003 0 0 0 1.905-1.24l1.723-1.723a.999.999 0 1 0-1.414-1.414L9.836 19.81a3.985 3.985 0 0 1-2.761 1.123 3.975 3.975 0 0 1-2.799-1.122 3.997 3.997 0 0 1-.111-5.644l3.005-3.006a3.982 3.982 0 0 1 3.395-1.126 3.987 3.987 0 0 1 2.632 1.563 1 1 0 0 0 1.602-1.198z"></path></svg></a></h1>
<p>To my knowledge there isn't much to configure on the docker provider side of things until you deploy a service.
But the provider config file should get a little screen time here.</p>
<p>The file defines a traefik http router for each service you define, in this case just <code>pihole</code>.</p>
<p>Here I am adding my pihole instance which is not run inside docker but is inside a VM on another host.
I want the <code>entryPoints</code> to be set to <code>websecure</code> which is configured above in the http redirects.
I want some middlewares, <code>addprefix-pihole</code> and <code>default-headers</code>, which I'll explain below.
I set letsencrypt as the cert certResolver.
Finally I name the service <code>pihole</code>.</p>
<p>Then in the <code>services</code> section I configure where pihole is located by just giving the internal IP for traefik to route to.
Finally I define my middlewares.
To get to the pihole homepage you need to use the route <code>/admin</code> so I want that added automatically when I go to <code>pihole.example.com</code> so I come to <code>pihole.example.com/admin</code>.
And I wanted to restrict access to just my internal network and my wireguard network - this is done with the <code>default-whitelist</code>.
The last thing is to configure a chain of middlewares that I called <code>secured</code> which is just easier for the docker labels later on.</p>
<p>With this config in play though, traefik will know about the route <code>pihole.example.com</code> and handle the ip whitelisting and load balancing for me.</p>
<pre class='wrapper'>

<div class='copy-wrapper'>

<button class='copy' title='copy code to clipboard' onclick="navigator.clipboard.writeText(this.parentElement.parentElement.querySelector('pre').textContent)"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 115.77 122.88" style="enable-background:new 0 0 115.77 122.88" xml:space="preserve"><style type="text/css">.st0{fill-rule:evenodd;clip-rule:evenodd;}</style><g><path class="st0" d="M89.62,13.96v7.73h12.19h0.01v0.02c3.85,0.01,7.34,1.57,9.86,4.1c2.5,2.51,4.06,5.98,4.07,9.82h0.02v0.02 v73.27v0.01h-0.02c-0.01,3.84-1.57,7.33-4.1,9.86c-2.51,2.5-5.98,4.06-9.82,4.07v0.02h-0.02h-61.7H40.1v-0.02 c-3.84-0.01-7.34-1.57-9.86-4.1c-2.5-2.51-4.06-5.98-4.07-9.82h-0.02v-0.02V92.51H13.96h-0.01v-0.02c-3.84-0.01-7.34-1.57-9.86-4.1 c-2.5-2.51-4.06-5.98-4.07-9.82H0v-0.02V13.96v-0.01h0.02c0.01-3.85,1.58-7.34,4.1-9.86c2.51-2.5,5.98-4.06,9.82-4.07V0h0.02h61.7 h0.01v0.02c3.85,0.01,7.34,1.57,9.86,4.1c2.5,2.51,4.06,5.98,4.07,9.82h0.02V13.96L89.62,13.96z M79.04,21.69v-7.73v-0.02h0.02 c0-0.91-0.39-1.75-1.01-2.37c-0.61-0.61-1.46-1-2.37-1v0.02h-0.01h-61.7h-0.02v-0.02c-0.91,0-1.75,0.39-2.37,1.01 c-0.61,0.61-1,1.46-1,2.37h0.02v0.01v64.59v0.02h-0.02c0,0.91,0.39,1.75,1.01,2.37c0.61,0.61,1.46,1,2.37,1v-0.02h0.01h12.19V35.65 v-0.01h0.02c0.01-3.85,1.58-7.34,4.1-9.86c2.51-2.5,5.98-4.06,9.82-4.07v-0.02h0.02H79.04L79.04,21.69z M105.18,108.92V35.65v-0.02 h0.02c0-0.91-0.39-1.75-1.01-2.37c-0.61-0.61-1.46-1-2.37-1v0.02h-0.01h-61.7h-0.02v-0.02c-0.91,0-1.75,0.39-2.37,1.01 c-0.61,0.61-1,1.46-1,2.37h0.02v0.01v73.27v0.02h-0.02c0,0.91,0.39,1.75,1.01,2.37c0.61,0.61,1.46,1,2.37,1v-0.02h0.01h61.7h0.02 v0.02c0.91,0,1.75-0.39,2.37-1.01c0.61-0.61,1-1.46,1-2.37h-0.02V108.92L105.18,108.92z"/></g></svg></button>
</div>
        
<div class="highlight"><pre><span></span><span class="nt">http</span><span class="p">:</span>
<span class="w"> </span><span class="c1">#region routers </span>
<span class="w">  </span><span class="nt">routers</span><span class="p">:</span>
<span class="w">    </span><span class="nt">pihole</span><span class="p">:</span>
<span class="w">      </span><span class="nt">entryPoints</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;websecure&quot;</span>
<span class="w">      </span><span class="nt">rule</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Host(`pihole.example.com`)&quot;</span>
<span class="w">      </span><span class="nt">middlewares</span><span class="p">:</span>
<span class="w">        </span><span class="c1"># - default-headers</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">addprefix-pihole</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default-whitelist</span>
<span class="w">      </span><span class="nt">tls</span><span class="p">:</span><span class="w"> </span>
<span class="w">        </span><span class="nt">certResolver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">letsencrypt</span>
<span class="w">      </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pihole</span>
<span class="w">  </span><span class="c1">#region services</span>
<span class="w">  </span><span class="nt">services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">pihole</span><span class="p">:</span>
<span class="w">      </span><span class="nt">loadBalancer</span><span class="p">:</span>
<span class="w">        </span><span class="nt">servers</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://192.168.1.3:80&quot;</span>
<span class="w">        </span><span class="nt">passHostHeader</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="c1">#endregion</span>
<span class="w">  </span><span class="nt">middlewares</span><span class="p">:</span>
<span class="w">    </span><span class="nt">addprefix-pihole</span><span class="p">:</span>
<span class="w">      </span><span class="nt">addPrefix</span><span class="p">:</span>
<span class="w">        </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/admin&quot;</span>
<span class="w">    </span><span class="nt">https-redirect</span><span class="p">:</span>
<span class="w">      </span><span class="nt">redirectScheme</span><span class="p">:</span>
<span class="w">        </span><span class="nt">scheme</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https</span>

<span class="w">    </span><span class="nt">default-headers</span><span class="p">:</span>
<span class="w">      </span><span class="nt">headers</span><span class="p">:</span>
<span class="w">        </span><span class="nt">frameDeny</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">sslRedirect</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">browserXssFilter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">contentTypeNosniff</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">forceSTSHeader</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">stsIncludeSubdomains</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">stsPreload</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">stsSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15552000</span>
<span class="w">        </span><span class="nt">customFrameOptionsValue</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SAMEORIGIN</span>

<span class="w">    </span><span class="nt">default-whitelist</span><span class="p">:</span>
<span class="w">      </span><span class="nt">ipWhiteList</span><span class="p">:</span>
<span class="w">        </span><span class="nt">sourceRange</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;10.6.0.0/24&quot;</span><span class="w">  </span><span class="c1"># wg</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;192.168.1.0/24&quot;</span><span class="w">  </span><span class="c1"># lan</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;172.17.0.0/16&quot;</span><span class="w">  </span><span class="c1"># docker</span>

<span class="w">    </span><span class="nt">secured</span><span class="p">:</span>
<span class="w">      </span><span class="nt">chain</span><span class="p">:</span>
<span class="w">        </span><span class="nt">middlewares</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default-whitelist</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default-headers</span>
</pre></div>

</pre>

<h1 id="docker-labels">Docker labels <a class="header-anchor" href="#docker-labels"><svg class="heading-permalink" aria-hidden="true" fill="currentColor" focusable="false" height="1em" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M9.199 13.599a5.99 5.99 0 0 0 3.949 2.345 5.987 5.987 0 0 0 5.105-1.702l2.995-2.994a5.992 5.992 0 0 0 1.695-4.285 5.976 5.976 0 0 0-1.831-4.211 5.99 5.99 0 0 0-6.431-1.242 6.003 6.003 0 0 0-1.905 1.24l-1.731 1.721a.999.999 0 1 0 1.41 1.418l1.709-1.699a3.985 3.985 0 0 1 2.761-1.123 3.975 3.975 0 0 1 2.799 1.122 3.997 3.997 0 0 1 .111 5.644l-3.005 3.006a3.982 3.982 0 0 1-3.395 1.126 3.987 3.987 0 0 1-2.632-1.563A1 1 0 0 0 9.201 13.6zm5.602-3.198a5.99 5.99 0 0 0-3.949-2.345 5.987 5.987 0 0 0-5.105 1.702l-2.995 2.994a5.992 5.992 0 0 0-1.695 4.285 5.976 5.976 0 0 0 1.831 4.211 5.99 5.99 0 0 0 6.431 1.242 6.003 6.003 0 0 0 1.905-1.24l1.723-1.723a.999.999 0 1 0-1.414-1.414L9.836 19.81a3.985 3.985 0 0 1-2.761 1.123 3.975 3.975 0 0 1-2.799-1.122 3.997 3.997 0 0 1-.111-5.644l3.005-3.006a3.982 3.982 0 0 1 3.395-1.126 3.987 3.987 0 0 1 2.632 1.563 1 1 0 0 0 1.602-1.198z"></path></svg></a></h1>
<p>Now the real magic is with Docker.
Here is an example docker-compose file for spinning up a <a href="https://jellyfin.org/">jellyfin</a> server that you want to expose to the world, or at least access at home with <code>jellyfin.example.com</code> instead of <code>http://192.168.1.N:8096</code>...</p>
<p>I left some of the ansible variable stuff in here, but the main part to be concerned with is the <code>labels</code> section...</p>
<p>We define just a few labels to throw onto this docker container which let's traefik discover it automatically and apply any settings necessary (like my <code>ipWhiteList</code>).</p>
<ul>
<li><code>traefik.enable</code> is either True or False.</li>
<li><code>traefik.http.router.jellyfin.rule</code> defines an http router called jellyfin and sets the url to <code>jellyfin.example.com</code> (if <a href="http://example.com">example.com</a> was my <code>ansible_nas_domain</code>)</li>
<li><code>traefik.http.routers.jellyfin.tls.certresolver</code> is set to letsencrypt since I use LE for my wildcard certs.</li>
<li><code>traefik.http.routers.jellyfin.tls.domains[0].main</code> will just be <code>example.com</code> -&gt; and this should remind you of the toml file above</li>
<li><code>traefik.http.routers.jellyfin.tls.domains[0].sans</code> is set to <code>*.example.com</code></li>
<li><code>traefik.http.services.jellyfin.loadbalancer.server.port</code> is set to jellyfin's default http port of 8096, which tells traefik which port to point to for this service.</li>
</ul>
<pre class='wrapper'>

<div class='copy-wrapper'>

<button class='copy' title='copy code to clipboard' onclick="navigator.clipboard.writeText(this.parentElement.parentElement.querySelector('pre').textContent)"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 115.77 122.88" style="enable-background:new 0 0 115.77 122.88" xml:space="preserve"><style type="text/css">.st0{fill-rule:evenodd;clip-rule:evenodd;}</style><g><path class="st0" d="M89.62,13.96v7.73h12.19h0.01v0.02c3.85,0.01,7.34,1.57,9.86,4.1c2.5,2.51,4.06,5.98,4.07,9.82h0.02v0.02 v73.27v0.01h-0.02c-0.01,3.84-1.57,7.33-4.1,9.86c-2.51,2.5-5.98,4.06-9.82,4.07v0.02h-0.02h-61.7H40.1v-0.02 c-3.84-0.01-7.34-1.57-9.86-4.1c-2.5-2.51-4.06-5.98-4.07-9.82h-0.02v-0.02V92.51H13.96h-0.01v-0.02c-3.84-0.01-7.34-1.57-9.86-4.1 c-2.5-2.51-4.06-5.98-4.07-9.82H0v-0.02V13.96v-0.01h0.02c0.01-3.85,1.58-7.34,4.1-9.86c2.51-2.5,5.98-4.06,9.82-4.07V0h0.02h61.7 h0.01v0.02c3.85,0.01,7.34,1.57,9.86,4.1c2.5,2.51,4.06,5.98,4.07,9.82h0.02V13.96L89.62,13.96z M79.04,21.69v-7.73v-0.02h0.02 c0-0.91-0.39-1.75-1.01-2.37c-0.61-0.61-1.46-1-2.37-1v0.02h-0.01h-61.7h-0.02v-0.02c-0.91,0-1.75,0.39-2.37,1.01 c-0.61,0.61-1,1.46-1,2.37h0.02v0.01v64.59v0.02h-0.02c0,0.91,0.39,1.75,1.01,2.37c0.61,0.61,1.46,1,2.37,1v-0.02h0.01h12.19V35.65 v-0.01h0.02c0.01-3.85,1.58-7.34,4.1-9.86c2.51-2.5,5.98-4.06,9.82-4.07v-0.02h0.02H79.04L79.04,21.69z M105.18,108.92V35.65v-0.02 h0.02c0-0.91-0.39-1.75-1.01-2.37c-0.61-0.61-1.46-1-2.37-1v0.02h-0.01h-61.7h-0.02v-0.02c-0.91,0-1.75,0.39-2.37,1.01 c-0.61,0.61-1,1.46-1,2.37h0.02v0.01v73.27v0.02h-0.02c0,0.91,0.39,1.75,1.01,2.37c0.61,0.61,1.46,1,2.37,1v-0.02h0.01h61.7h0.02 v0.02c0.91,0,1.75-0.39,2.37-1.01c0.61-0.61,1-1.46,1-2.37h-0.02V108.92L105.18,108.92z"/></g></svg></button>
</div>
        
<div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jellyfin</span>
<span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">linuxserver/jellyfin</span>
<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">jellyfin_config_directory</span><span class="nv"> </span><span class="s">}}:/config:rw&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">jellyfin_movies_directory</span><span class="nv"> </span><span class="s">}}:/movies:{{</span><span class="nv"> </span><span class="s">jellyfin_movies_permissions</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">jellyfin_music_directory</span><span class="nv"> </span><span class="s">}}:/music:{{</span><span class="nv"> </span><span class="s">jellyfin_music_permissions</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">jellyfin_photos_directory</span><span class="nv"> </span><span class="s">}}:/photos:{{</span><span class="nv"> </span><span class="s">jellyfin_photos_permissions</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">jellyfin_tv_directory</span><span class="nv"> </span><span class="s">}}:/tv:{{</span><span class="nv"> </span><span class="s">jellyfin_tv_permissions</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">jellyfin_books_directory</span><span class="nv"> </span><span class="s">}}:/books:{{</span><span class="nv"> </span><span class="s">jellyfin_books_permissions</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">jellyfin_audiobooks_directory</span><span class="nv"> </span><span class="s">}}:/audiobooks:{{</span><span class="nv"> </span><span class="s">jellyfin_audiobooks_permissions</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="nt">ports</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">jellyfin_port_http</span><span class="nv"> </span><span class="s">}}:8096&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">jellyfin_port_https</span><span class="nv"> </span><span class="s">}}:8920&quot;</span>
<span class="nt">env</span><span class="p">:</span>
<span class="w">  </span><span class="nt">TZ</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">ansible_nas_timezone</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">  </span><span class="nt">PUID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">jellyfin_user_id</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">  </span><span class="nt">PGID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">jellyfin_group_id</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="nt">restart_policy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
<span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1g</span>
<span class="nt">labels</span><span class="p">:</span>
<span class="w">  </span><span class="nt">traefik.enable</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">jellyfin_available_externally</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">  </span><span class="nt">traefik.http.routers.jellyfin.rule</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Host(`jellyfin.{{</span><span class="nv"> </span><span class="s">ansible_nas_domain</span><span class="nv"> </span><span class="s">}}`)&quot;</span>
<span class="w">  </span><span class="nt">traefik.http.routers.jellyfin.tls.certresolver</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;letsencrypt&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">traefik.http.routers.jellyfin.tls.domains[0].main</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">ansible_nas_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">traefik.http.routers.jellyfin.tls.domains[0].sans</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;*.{{</span><span class="nv"> </span><span class="s">ansible_nas_domain</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">  </span><span class="nt">traefik.http.services.jellyfin.loadbalancer.server.port</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;8096&quot;</span>
</pre></div>

</pre>

<p>And just like that traefik will automagically find your jellyfin container and route <code>jellyfin.example.com</code> to it!</p>

    </section>
</article>